variable "region" {
  description = "AWS region"
  type        = string
}

variable "target_group_arn" {
  description = "ARN of the existing target group"
  type        = string
}

variable "instance_ids" {
  description = "List of EC2 instance IDs to add to the target group"
  type        = list(string)
}





region             = "your_aws_region"
target_group_arn   = "arn:aws:elasticloadbalancing:your_region:your_account_id:targetgroup/your-target-group-name/your_target_group_id"
instance_ids       = ["instance_id_1", "instance_id_2", "instance_id_3"]



provider "aws" {
  region = var.region
}

resource "aws_lb_target_group_attachment" "example" {
  count             = length(var.instance_ids)
  target_group_arn = var.target_group_arn
  target_id         = var.instance_ids[count.index]
}





provider "aws" {
  region = var.region
}

resource "aws_instance" "example" {
  count = length(var.instance_ids)

  ami           = "your_ami_id"
  instance_type = "t2.micro"

  tags = {
    Name = "instance-${count.index}"
  }
}

resource "aws_network_interface_attachment" "example" {
  count                  = length(var.instance_ids)
  security_group_ids    = [var.security_group_id]
  network_interface_ids = [element(aws_instance.example.*.network_interface_ids, count.index)]
}


resource "aws_instance" "example" {
  count         = length(var.instance_ids)
  instance_id   = var.instance_ids[count.index]
  security_group_ids = [var.security_group_id]
}
