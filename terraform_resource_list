#!/bin/bash

# Ensure the script fails on any error
set -e

# Header
echo "Type,Name" > resources.csv

# Loop through all resources in the Terraform state
terraform state list | while read -r resource; do
    # Extract type and name
    resource_type=$(echo "$resource" | cut -d'.' -f1)
    resource_name=$(echo "$resource" | cut -d'.' -f2)
    echo "$resource_type,$resource_name" >> resources.csv
done

echo "Resources have been exported to resources.csv"
